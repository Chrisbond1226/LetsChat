(this.webpackJsonpourchat=this.webpackJsonpourchat||[]).push([[0],{77:function(e,t,n){},80:function(e,t,n){"use strict";n.r(t);var a,c,s,r,i,o,d,l,j,u,b,m=n(1),O=n.n(m),h=n(66),p=n.n(h),x=(n(77),n(18)),f=n(17),v=n(6),g=n(69),y=n(91),w=n(93),N=n(90),C=n(67),k=n(30),S=n(31),_=n(57),$=new(function(){function e(){Object(k.a)(this,e)}return Object(S.a)(e,[{key:"getProfile",value:function(){return Object(_.a)(this.getToken())}},{key:"loggedIn",value:function(){var e=this.getToken();return!!e&&!this.isTokenExpired(e)}},{key:"isTokenExpired",value:function(e){try{return Object(_.a)(e).exp<Date.now()/1e3}catch(t){return!1}}},{key:"getToken",value:function(){return localStorage.getItem("id_token")}},{key:"login",value:function(e){localStorage.setItem("id_token",e),window.location.assign("/")}},{key:"logout",value:function(){localStorage.removeItem("id_token"),window.location.assign("/")}}]),e}()),I=n(2),T=function(){return Object(I.jsx)("header",{className:"bg-secondary mb-4 py-2 flex-row align-center",children:Object(I.jsxs)("div",{className:"container flex-row justify-space-between-lg justify-center align-center",children:[Object(I.jsx)(f.b,{to:"/",children:Object(I.jsx)("h1",{children:"Lets Chat"})}),Object(I.jsx)("nav",{className:"text-center",children:$.loggedIn()?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(f.b,{to:"/profile",children:"Me"}),Object(I.jsx)("a",{href:"/",onClick:function(e){e.preventDefault(),$.logout()},children:"Logout"})]}):Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(f.b,{to:"/login",children:"Login"}),Object(I.jsx)(f.b,{to:"/signup",children:"Signup"})]})})]})})},A=function(){return Object(I.jsx)("footer",{className:"w-100 mt-auto bg-secondary p-4",children:Object(I.jsxs)("div",{className:"container",children:["\xa9",(new Date).getFullYear()," by Chris, Scott, Guy, Max and jocelyn"]})})},F=function(e){var t=e.posts,n=e.title;return t.length?Object(I.jsxs)("div",{children:[Object(I.jsx)("h3",{children:n}),t&&t.map((function(e){return Object(I.jsxs)("div",{children:[Object(I.jsxs)("h4",{className:"card-header",children:[Object(I.jsx)(f.b,{to:"/profile/".concat(e.username),style:{fontWeight:700},className:"text-light",children:e.username})," "]}),Object(I.jsx)("div",{children:Object(I.jsxs)(f.b,{to:"/post/".concat(e._id),children:[Object(I.jsx)("p",{className:"card-body",children:e.postText}),Object(I.jsxs)("p",{className:"comments",children:["Posted on ",e.createdAt," ",Object(I.jsx)("br",{}),"Comments: ",e.commentCount," ||"," ",e.commentCount?"View":"Start"," the commentary!"]})]})})]},e._id)}))]}):Object(I.jsx)("h3",{children:"No posts yet"})},B=n(7),D=n(12),L=n(19),P=n(9),q=n(87),U=n(20),W=n(92),M=Object(W.a)(a||(a=Object(U.a)(["\n  mutation login($email: String!, $password: String!) {\n    login(email: $email, password: $password) {\n      token\n      user {\n        _id\n        username\n      }\n    }\n  }\n"]))),E=Object(W.a)(c||(c=Object(U.a)(["\n  mutation addUser($username: String!, $email: String!, $password: String!) {\n    addUser(username: $username, email: $email, password: $password) {\n      token\n      user {\n        _id\n        username\n      }\n    }\n  }\n"]))),Q=Object(W.a)(s||(s=Object(U.a)(["\n  mutation addPost($postText: String!) {\n    addPost(postText: $postText) {\n      _id\n      postText\n      createdAt\n      username\n      commentCount\n      comments {\n        _id\n      }\n    }\n  }\n"]))),Y=Object(W.a)(r||(r=Object(U.a)(["\n  mutation addComment($postId: ID!, $commentBody: String!) {\n    addComment(postId: $postId, commentBody: $commentBody) {\n      _id\n      commentCount\n      comments {\n        _id\n        commentBody\n        createdAt\n        username\n      }\n    }\n  }\n"]))),J=Object(W.a)(i||(i=Object(U.a)(["\n  mutation addFriend($id: ID!) {\n    addFriend(friendId: $id) {\n      _id\n      username\n      friendCount\n      friends {\n        _id\n        username\n      }\n    }\n  }\n"]))),V=(Object(W.a)(o||(o=Object(U.a)(["\n  mutation removeFriend($id: ID!) {\n    removeFriend(id: $id) {\n      _id\n      username\n      friends {\n        _id\n        username\n      }\n    }\n  }\n"]))),Object(W.a)(d||(d=Object(U.a)(["\n  query posts($username: String) {\n    posts(username: $username) {\n      _id\n      postText\n      createdAt\n      username\n      commentCount\n      comments {\n        _id\n        createdAt\n        username\n        commentBody\n      }\n    }\n  }\n"])))),z=Object(W.a)(l||(l=Object(U.a)(["\n  query post($id: ID!) {\n    post(_id: $id) {\n      _id\n      postText\n      createdAt\n      username\n      commentCount\n      comments {\n        _id\n        createdAt\n        username\n        commentBody\n      }\n    }\n  }\n"]))),G=Object(W.a)(j||(j=Object(U.a)(["\n  query user($username: String!) {\n    user(username: $username) {\n      _id\n      username\n      email\n      friendCount\n      friends {\n        _id\n        username\n      }\n      posts {\n        _id\n        postText\n        createdAt\n        commentCount\n      }\n    }\n  }\n"]))),H=Object(W.a)(u||(u=Object(U.a)(["\n  {\n    me {\n      _id\n      username\n      email\n      friendCount\n      posts {\n        _id\n        postText\n        createdAt\n        commentCount\n        comments {\n          _id\n          createdAt\n          commentBody\n          username\n        }\n      }\n      friends {\n        _id\n        username\n      }\n    }\n  }\n"]))),K=Object(W.a)(b||(b=Object(U.a)(["\n  {\n    me {\n      _id\n      username\n      email\n      friendCount\n      friends {\n        _id\n        username\n      }\n    }\n  }\n"]))),R=function(){var e=Object(m.useState)(""),t=Object(P.a)(e,2),n=t[0],a=t[1],c=Object(m.useState)(0),s=Object(P.a)(c,2),r=s[0],i=s[1],o=Object(q.a)(Q,{update:function(e,t){var n=t.data.addPost;try{var a=e.readQuery({query:H}).me;e.writeQuery({query:H,data:{me:Object(x.a)(Object(x.a)({},a),{},{posts:[].concat(Object(L.a)(a.posts),[n])})}})}catch(s){console.warn("First post by this user!")}var c=e.readQuery({query:V}).posts;e.writeQuery({query:V,data:{posts:[n].concat(Object(L.a)(c))}})}}),d=Object(P.a)(o,2),l=d[0],j=d[1].error,u=function(){var e=Object(D.a)(Object(B.a)().mark((function e(t){return Object(B.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,l({variables:{postText:n}});case 4:a(""),i(0),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(I.jsx)("div",{children:Object(I.jsxs)("form",{className:"flex-row justify-center justify-space-between-md align-stretch",onSubmit:u,children:[Object(I.jsx)("textarea",{className:"form-input col-12 col-md-9",placeholder:"What is on your mind?",value:n,onChange:function(e){e.target.value.length<=280&&(a(e.target.value),i(e.target.value.length))}})," ",Object(I.jsx)("br",{}),Object(I.jsxs)("p",{children:["Character Count: ",r,"/",280,j&&Object(I.jsx)("span",{children:"Something went wrong..."})]}),Object(I.jsx)("br",{}),Object(I.jsx)("button",{className:"button-29 btn",type:"submit",children:"Submit"})]})})},X=function(e){var t=e.friendCount,n=e.friends;return n&&n.length?Object(I.jsxs)("div",{children:[Object(I.jsxs)("h5",{children:["My ",1===t?"friend":"friends"]}),n.map((function(e){return Object(I.jsx)("button",{className:"button-29",children:Object(I.jsx)(f.b,{to:"/profile/".concat(e.username),children:e.username})},e._id)}))]}):Object(I.jsx)("p",{children:"Make some friends!"})},Z=n(95),ee=function(){var e=Object(Z.a)(V),t=e.loading,n=e.data,a=Object(Z.a)(K).data,c=(null===n||void 0===n?void 0:n.posts)||[],s=$.loggedIn();return Object(I.jsx)("main",{children:Object(I.jsxs)("div",{className:"flex-row justify-space-between",children:[s&&Object(I.jsx)("div",{className:"col-12 mb-3",children:Object(I.jsx)(R,{})}),Object(I.jsx)("div",{className:"col-12 mb-3 ".concat(s&&"col-lg-8"),children:t?Object(I.jsx)("div",{children:"Loading..."}):Object(I.jsx)(F,{posts:c,title:"What's the Word?"})}),s&&a?Object(I.jsx)("div",{className:"col-12 col-lg-3 mb-3",children:Object(I.jsx)(X,{username:a.me.username,friendCount:a.me.friendCount,friends:a.me.friends})}):null]})})},te=n(14),ne=function(e){var t=Object(m.useState)({email:"",password:""}),n=Object(P.a)(t,2),a=n[0],c=n[1],s=Object(q.a)(M),r=Object(P.a)(s,2),i=r[0],o=r[1].error,d=function(e){var t=e.target,n=t.name,s=t.value;c(Object(x.a)(Object(x.a)({},a),{},Object(te.a)({},n,s)))},l=function(){var e=Object(D.a)(Object(B.a)().mark((function e(t){var n,s;return Object(B.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,i({variables:Object(x.a)({},a)});case 4:n=e.sent,s=n.data,$.login(s.login.token),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0);case 12:c({email:"",password:""});case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(I.jsx)("main",{children:Object(I.jsx)("div",{children:Object(I.jsxs)("div",{className:"card",children:[Object(I.jsx)("h4",{className:"card-header",children:"Login"}),Object(I.jsxs)("div",{className:"card-body",children:[Object(I.jsxs)("form",{onSubmit:l,children:[Object(I.jsx)("input",{className:"form-input",placeholder:"Email",name:"email",type:"email",id:"email",value:a.email,onChange:d}),Object(I.jsx)("input",{className:"form-input",placeholder:"Password",name:"password",type:"password",id:"password",value:a.password,onChange:d}),Object(I.jsx)("button",{className:"btn",type:"submit",children:"Submit"})]}),o&&Object(I.jsx)("div",{children:"Login unsuccessful"})]})]})})})},ae=function(){var e=Object(m.useState)({username:"",email:"",password:""}),t=Object(P.a)(e,2),n=t[0],a=t[1],c=Object(q.a)(E),s=Object(P.a)(c,2),r=s[0],i=s[1].error,o=function(e){var t=e.target,c=t.name,s=t.value;a(Object(x.a)(Object(x.a)({},n),{},Object(te.a)({},c,s)))},d=function(){var e=Object(D.a)(Object(B.a)().mark((function e(t){var a,c;return Object(B.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,r({variables:Object(x.a)({},n)});case 4:a=e.sent,c=a.data,$.login(c.addUser.token),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(I.jsx)("main",{className:"flex-row justify-center mb-4",children:Object(I.jsx)("div",{className:"col-12 col-md-6",children:Object(I.jsxs)("div",{className:"card",children:[Object(I.jsx)("h4",{className:"card-header",children:"Sign Up"}),Object(I.jsxs)("div",{className:"card-body",children:[Object(I.jsxs)("form",{onSubmit:d,children:[Object(I.jsx)("input",{className:"form-input",placeholder:"Your username",name:"username",type:"username",id:"username",value:n.username,onChange:o}),Object(I.jsx)("input",{className:"form-input",placeholder:"Your email",name:"email",type:"email",id:"email",value:n.email,onChange:o}),Object(I.jsx)("input",{className:"form-input",placeholder:"******",name:"password",type:"password",id:"password",value:n.password,onChange:o}),Object(I.jsx)("button",{className:"btn d-block w-100",type:"submit",children:"Submit"})]}),i&&Object(I.jsx)("div",{children:"Signup failed"})]})]})})})},ce=function(e){var t=Object(v.o)().username,n=Object(q.a)(J),a=Object(P.a)(n,1)[0],c=Object(Z.a)(t?G:H,{variables:{username:t}}),s=c.loading,r=c.data,i=(null===r||void 0===r?void 0:r.me)||(null===r||void 0===r?void 0:r.user)||{};if($.loggedIn()&&$.getProfile().data.username===t)return Object(I.jsx)(v.a,{to:"/profile:username"});if(s)return Object(I.jsx)("div",{children:"Loading..."});if(null===i||void 0===i||!i.username)return Object(I.jsx)("h4",{children:"You need to be logged in to see this. Use the navigation links above to sign up or log in!"});var o=function(){var e=Object(D.a)(Object(B.a)().mark((function e(){return Object(B.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a({variables:{id:i._id}});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();return Object(I.jsxs)("div",{children:[Object(I.jsxs)("div",{className:"flex-row mb-3",children:[Object(I.jsxs)("h2",{className:"bg-dark text-secondary p-3 display-inline-block",children:["Viewing ",t?"".concat(i.username,"'s"):"your"," profile."]}),t&&Object(I.jsx)("button",{className:"btn ml-auto",onClick:o,children:"Add Friend"})]}),Object(I.jsxs)("div",{className:"flex-row justify-space-between mb-3",children:[Object(I.jsx)("div",{className:"col-12 mb-3 col-lg-8",children:Object(I.jsx)(F,{posts:i.posts,title:"".concat(i.username,"'s posts...")})}),Object(I.jsx)("div",{className:"col-12 col-lg-3 mb-3",children:Object(I.jsx)(X,{username:i.username,friendCount:i.friendCount,friends:i.friends})})]}),Object(I.jsx)("div",{className:"mb-3",children:!t&&Object(I.jsx)(R,{})})]})},se=function(){return Object(I.jsx)("div",{children:"Oops, we couldn't find that page."})},re=function(e){var t=e.comments;return Object(I.jsxs)("div",{className:"card mb-3",children:[Object(I.jsx)("div",{className:"card-header",children:Object(I.jsx)("span",{className:"text-light",children:"Comments"})}),Object(I.jsx)("div",{className:"card-body",children:t&&t.map((function(e){return Object(I.jsxs)("p",{className:"pill mb-3",children:[e.commentBody," //"," ",Object(I.jsxs)(f.b,{to:"/profile/".concat(e.username),style:{fontWeight:700},children:[e.username," on ",e.createdAt]})]},e._id)}))})]})},ie=function(e){var t=e.postId,n=Object(m.useState)(""),a=Object(P.a)(n,2),c=a[0],s=a[1],r=Object(m.useState)(0),i=Object(P.a)(r,2),o=i[0],d=i[1],l=Object(q.a)(Y),j=Object(P.a)(l,2),u=j[0],b=j[1].error,O=function(){var e=Object(D.a)(Object(B.a)().mark((function e(n){return Object(B.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,u({variables:{commentBody:c,postId:t}});case 4:s(" "),d(0),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(I.jsxs)("div",{children:[Object(I.jsxs)("p",{className:"m-0 ".concat(280===o||b?"text-error":""),children:["Character Count: ",o,"/280",b&&Object(I.jsx)("span",{className:"ml-2",children:"Uh oh Something went wrong..."})]}),Object(I.jsxs)("form",{className:"flex-row justify-center justify-space-between-md align-stretch",onSubmit:O,children:[Object(I.jsx)("textarea",{placeholder:"leave a comment",value:c,className:"form-input col-12 col-md-9",onChange:function(e){e.target.value.length<=280&&(s(e.target.value),d(e.target.value.length))}}),Object(I.jsx)("button",{className:"btn col-12 col-md-3",type:"submit",children:"Submit"})]}),b&&Object(I.jsx)("div",{children:"Uh Oh Something went wrong"})]})},oe=function(e){var t=Object(v.o)().id,n=Object(Z.a)(z,{variables:{id:t}}),a=n.loading,c=n.data,s=(null===c||void 0===c?void 0:c.post)||{};return a?Object(I.jsx)("div",{children:"Loading..."}):Object(I.jsxs)("div",{children:[Object(I.jsxs)("div",{className:"card mb-3",children:[Object(I.jsxs)("p",{className:"card-header",children:[Object(I.jsx)("span",{style:{fontWeight:700},className:"text-light",children:s.username})," ","post on ",s.createdAt]}),Object(I.jsx)("div",{className:"card-body",children:Object(I.jsx)("p",{children:s.postText})})]}),s.commentCount>0&&Object(I.jsx)(re,{comments:s.comments}),$.loggedIn()&&Object(I.jsx)(ie,{postId:s._id})]})},de=Object(g.a)({uri:"/graphql"}),le=Object(C.a)((function(e,t){var n=t.headers,a=localStorage.getItem("id_token");return{headers:Object(x.a)(Object(x.a)({},n),{},{authorization:a?"Bearer ".concat(a):""})}})),je=new y.a({link:le.concat(de),cache:new w.a});var ue=function(){return Object(I.jsx)(N.a,{client:je,children:Object(I.jsx)(f.a,{children:Object(I.jsxs)("div",{className:"",children:[Object(I.jsx)(T,{}),Object(I.jsx)("div",{className:"container",children:Object(I.jsxs)(v.d,{children:[Object(I.jsx)(v.b,{path:"/",element:Object(I.jsx)(ee,{})}),Object(I.jsx)(v.b,{path:"/login",element:Object(I.jsx)(ne,{})}),Object(I.jsx)(v.b,{path:"/signup",element:Object(I.jsx)(ae,{})}),Object(I.jsx)(v.b,{path:"/profile",element:Object(I.jsx)(ce,{})}),Object(I.jsx)(v.b,{path:"/post/:id",element:Object(I.jsx)(oe,{})}),Object(I.jsx)(v.b,{path:"*",element:Object(I.jsx)(se,{})})]})}),Object(I.jsx)(A,{})]})})})},be=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,96)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,s=t.getLCP,r=t.getTTFB;n(e),a(e),c(e),s(e),r(e)}))};p.a.render(Object(I.jsx)(O.a.StrictMode,{children:Object(I.jsx)(ue,{})}),document.getElementById("root")),be()}},[[80,1,2]]]);
//# sourceMappingURL=main.adcfa4df.chunk.js.map